<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>يلا عزوزي - البث المباشر للمباريات المشفرة</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        :root { --bg: #0b0e14; --accent: #00ffcc; --card: #161b22; }
        body { background-color: var(--bg); color: #fff; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        #player-container { background: #000; border-radius: 12px; overflow: hidden; position: relative; margin-bottom: 20px; box-shadow: 0 0 30px rgba(0,255,204,0.1); }
        .video-wrapper { position: relative; padding-bottom: 56.25%; height: 0; }
        .video-wrapper iframe, .video-wrapper video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }
        .channel-card { background: var(--card); border: 1px solid #30363d; border-radius: 10px; cursor: pointer; transition: 0.3s; }
        .channel-card:hover { border-color: var(--accent); transform: scale(1.03); }
        .channel-logo { width: 50px; height: 50px; object-fit: contain; }
        .category-title { border-right: 4px solid var(--accent); padding-right: 15px; margin: 25px 0; }
    </style>
</head>
<body>

<div class="container py-4">
    <h1 class="text-center mb-4 text-info">YALLA AZZOUZI <span class="text-white">LIVE</span></h1>

    <div id="player-container" class="d-none">
        <div class="video-wrapper">
            <video id="hlsPlayer" controls autoplay class="d-none"></video>
            <iframe id="iframePlayer" src="" allowfullscreen class="d-none"></iframe>
        </div>
        <div class="p-3 bg-dark d-flex justify-content-between align-items-center">
            <h5 id="currentChannelName" class="m-0 text-accent">اختر قناة لبدء البث</h5>
            <button class="btn btn-sm btn-outline-info" onclick="location.reload()">تحديث المشغل</button>
        </div>
    </div>

    <h3 class="category-title">القنوات الرياضية المشفرة</h3>
    <div id="channelsGrid" class="row g-3">
        </div>
</div>

<script>
    const hlsPlayer = document.getElementById('hlsPlayer');
    const iframePlayer = document.getElementById('iframePlayer');
    const playerContainer = document.getElementById('player-container');
    const channelNameText = document.getElementById('currentChannelName');
    const channelsGrid = document.getElementById('channelsGrid');

    // وظيفة تشغيل القناة الذكية
    function playChannel(url, name, type = 'hls') {
        playerContainer.classList.remove('d-none');
        channelNameText.innerText = "تشغيل الآن: " + name;
        window.scrollTo({ top: 0, behavior: 'smooth' });

        if (type === 'iframe') {
            hlsPlayer.classList.add('d-none');
            iframePlayer.classList.remove('d-none');
            iframePlayer.src = url;
            hlsPlayer.pause();
        } else {
            iframePlayer.classList.add('d-none');
            hlsPlayer.classList.remove('d-none');
            iframePlayer.src = "";
            
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(hlsPlayer);
                hls.on(Hls.Events.MANIFEST_PARSED, () => hlsPlayer.play());
            } else if (hlsPlayer.canPlayType('application/vnd.apple.mpegurl')) {
                hlsPlayer.src = url;
                hlsPlayer.play();
            }
        }
    }

    // تحميل القنوات من الملف المحدث تلقائياً
    async function loadChannels() {
        try {
            const response = await fetch('channels.json');
            const data = await response.json();
            
            // إضافة قنوات Iframe يدوية (سيرفرات قوية لا تتوقف)
            const premiumChannels = [
                { name: "beIN Sports 1 Premium", url: "https://vdo.m7sy.com/e/be1", logo: "https://upload.wikimedia.org/wikipedia/commons/b/bc/BeIN_Sports_logo.svg", type: "iframe" },
                { name: "SSC Sports 1 HD", url: "https://vdo.m7sy.com/e/ssc1", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/SSC_Logo.svg/1200px-SSC_Logo.svg.png", type: "iframe" }
            ];

            const allChannels = [...premiumChannels, ...data.channels];

            allChannels.forEach(ch => {
                const col = document.createElement('div');
                col.className = 'col-6 col-md-3 col-lg-2';
                col.innerHTML = `
                    <div class="channel-card p-3 text-center h-100" onclick="playChannel('${ch.url}', '${ch.name}', '${ch.type || 'hls'}')">
                        <img src="${ch.logo}" class="channel-logo mb-2" onerror="this.src='assets/img/default-logo.png'">
                        <div class="small fw-bold">${ch.name}</div>
                    </div>
                `;
                channelsGrid.appendChild(col);
            });
        } catch (e) { console.error("Error loading channels:", e); }
    }

    loadChannels();
</script>
</body>
</html>
